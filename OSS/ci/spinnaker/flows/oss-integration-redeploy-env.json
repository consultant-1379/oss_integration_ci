{
  "appConfig": {},
  "application": "ossapp",
  "id": "5387beec-02b8-4dec-8dac-e22efd71904e",
  "index": 9,
  "keepWaitingPipelines": false,
  "lastModifiedBy": "eruagar",
  "limitConcurrent": false,
  "name": "oss-integration-redeploy-env",
  "parameterConfig":   [
        {
      "default": "install",
      "description": "Option to set the deployment type set either \"install\" or \"upgrade\"",
      "hasOptions": false,
      "label": "DEPLOYMENT_TYPE",
      "name": "DEPLOYMENT_TYPE",
      "options": [{"value": ""}],
      "pinned": false,
      "required": true
    },
        {
      "default": "1.16.0-26",
      "description": "Install a version of the Base Helm Chart",
      "hasOptions": false,
      "label": "INT_CHART_VERSION",
      "name": "INT_CHART_VERSION",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "3600",
      "description": "Time in seconds for the deployment manager to wait for the deployment to complete",
      "hasOptions": false,
      "label": "HELM_TIMEOUT",
      "name": "HELM_TIMEOUT",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "OSS/ci/site-values/site_values-latest.yaml",
      "description": "The Path where all the necessary site values are located for the install/upgrade",
      "hasOptions": false,
      "label": "PATH_TO_SITE_VALUES",
      "name": "PATH_TO_SITE_VALUES",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "Namespace to install the EO Chart",
      "hasOptions": false,
      "label": "NAMESPACE",
      "name": "NAMESPACE",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "proj-eric-oss-drop-helm",
      "description": "Helm Chart Repository name",
      "hasOptions": false,
      "label": "HELM_REPOSITORY_NAME",
      "name": "HELM_REPOSITORY_NAME",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "true",
      "description": "Option to Deploy SO set either \"true\" or \"false\"",
      "hasOptions": false,
      "label": "SO_DEPLOY",
      "name": "SO_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "EO SO HOSTNAME",
      "hasOptions": false,
      "label": "SO_HOSTNAME",
      "name": "SO_HOSTNAME",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "true",
      "description": "Option to Deploy Policy Framework set either \"true\" or \"false\"",
      "hasOptions": false,
      "label": "PF_DEPLOY",
      "name": "PF_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "PF HOSTNAME",
      "hasOptions": false,
      "label": "PF_HOSTNAME",
      "name": "PF_HOSTNAME",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "true",
      "description": "Option to Deploy UDS set either \"true\" or \"false\"",
      "hasOptions": false,
      "label": "UDS_DEPLOY",
      "name": "UDS_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "true",
      "description": "Option to Deploy PLATFORM set either \"true\" or \"false\"",
      "hasOptions": false,
      "label": "PLATFORM_DEPLOY",
      "name": "PLATFORM_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "UDS HOSTNAME",
      "hasOptions": false,
      "label": "UDS_HOSTNAME",
      "name": "UDS_HOSTNAME",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "IAM HOSTNAME",
      "hasOptions": false,
      "label": "IAM_HOSTNAME",
      "name": "IAM_HOSTNAME",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "The Path where all the necessary certs are located for the install/upgrade",
      "hasOptions": false,
      "label": "PATH_TO_CERTIFICATES_FILES ",
      "name": "PATH_TO_CERTIFICATES_FILES ",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "",
      "description": "ID of the Kube Config file to use that is stoged in Jenkins",
      "hasOptions": false,
      "label": "KUBE_CONFIG",
      "name": "KUBE_CONFIG",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "cloudman-user-creds",
      "description": " Functional user which has access to docker ARM, artifactory etc.",
      "hasOptions": false,
      "label": "FUNCTIONAL_USER_SECRET",
      "name": "FUNCTIONAL_USER_SECRET",
      "options": [{"value": ""}],
      "pinned": false,
      "required": true
    },
        {
      "default": "",
      "description": "This is the name of the Resource To Unreserve",
      "hasOptions": false,
      "label": "RESOURCE_NAME",
      "name": "RESOURCE_NAME",
      "options": [{"value": ""}],
      "pinned": false,
      "required": true
    },
        {
      "default": "",
      "description": "GAS_HOSTNAME",
      "hasOptions": false,
      "label": "GAS_HOSTNAME",
      "name": "GAS_HOSTNAME",
      "options": [{"value": ""}],
      "pinned": true,
      "required": true
    },
        {
      "default": "true",
      "description": "ADC Deploy, set \"true\" or \"false\"",
      "hasOptions": false,
      "label": "ADC_DEPLOY",
      "name": "ADC_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": false
    },
        {
      "default": "true",
      "description": "DMM DEPLOY, set \"true\" or \"false\"",
      "hasOptions": false,
      "label": "DMM_DEPLOY",
      "name": "DMM_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": false
    },
        {
      "default": "true",
      "description": "Topology Handling Deploy, set \"true\" or \"false\"",
      "hasOptions": false,
      "label": "TH_DEPLOY",
      "name": "TH_DEPLOY",
      "options": [{"value": ""}],
      "pinned": true,
      "required": false
    }
  ],
  "schema": "1",
  "stages":   [
        {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "OSS-Integration-Helm-Chart-Deploy",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Base Chart Deploy",
      "notifications": [      {
        "address": "PDLDUNPROD@pdl.internal.ericsson.com",
        "cc": "",
        "level": "stage",
        "message": {"stage.failed": {"text": "The Base Chart Deploy phase in the oss-integration-redeploy-env pipe has failed."}},
        "type": "email",
        "when": ["stage.failed"]
      }],
      "parameters":       {
        "ADC_DEPLOY": "${trigger['parameters']['ADC_DEPLOY']}",
        "ARMDOCKER_USER_SECRET": "cloudman-docker-auth-config",
        "DEPLOYMENT_TYPE": "${trigger['parameters']['DEPLOYMENT_TYPE']}",
        "DMM_DEPLOY": "${trigger['parameters']['DMM_DEPLOY']}",
        "FULL_PATH_TO_SITE_VALUES_FILE": "${trigger['parameters']['PATH_TO_SITE_VALUES']}",
        "FUNCTIONAL_USER_SECRET": "${trigger['parameters']['FUNCTIONAL_USER_SECRET']}",
        "GAS_HOSTNAME": "${trigger['parameters']['GAS_HOSTNAME']}",
        "HELM_REPOSITORY_NAME": "${trigger['parameters']['HELM_REPOSITORY_NAME']}",
        "HELM_TIMEOUT": "${trigger['parameters']['HELM_TIMEOUT']}",
        "IAM_HOSTNAME": "${trigger['parameters']['IAM_HOSTNAME']}",
        "INT_CHART_VERSION": "${#stage(\"Get Latest Base Chart Version\")[\"context\"][\"INT_CHART_VERSION\"]}",
        "KUBECONFIG_FILE": "${trigger['parameters']['KUBE_CONFIG']}",
        "NAMESPACE": "${trigger['parameters']['NAMESPACE']}",
        "PATH_TO_CERTIFICATES_FILES": "${trigger['parameters']['PATH_TO_CERTIFICATES_FILES ']}",
        "PF_DEPLOY": "${trigger['parameters']['PF_DEPLOY']}",
        "PF_HOSTNAME": "${trigger['parameters']['PF_HOSTNAME']}",
        "PLATFORM_DEPLOY": "${trigger['parameters']['PLATFORM_DEPLOY']}",
        "SLAVE_LABEL": "evo_docker_engine_gic_IDUN",
        "SO_DEPLOY": "${trigger['parameters']['SO_DEPLOY']}",
        "SO_HOSTNAME": "${trigger['parameters']['SO_HOSTNAME']}",
        "TH_DEPLOY": "${trigger['parameters']['TH_DEPLOY']}",
        "UDS_DEPLOY": "${trigger['parameters']['UDS_DEPLOY']}",
        "UDS_HOSTNAME": "${trigger['parameters']['UDS_HOSTNAME']}"
      },
      "propertyFile": "",
      "refId": "1",
      "requisiteStageRefIds": ["4"],
      "sendNotifications": true,
      "stageEnabled":       {
        "expression": "${#stage(\"Check Deployment Status\")[\"context\"][\"SKIP_DELETION\"].contains(\"false\")}",
        "type": "expression"
      },
      "type": "jenkins"
    },
        {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "OSS-Integration-Purge",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Delete Deployment",
      "notifications": [      {
        "address": "PDLDUNPROD@pdl.internal.ericsson.com",
        "cc": "",
        "level": "stage",
        "message": {"stage.failed": {"text": "The Delete Deployment phase in the oss-integration-redeploy-env pipe has failed."}},
        "type": "email",
        "when": ["stage.failed"]
      }],
      "parameters":       {
        "KUBECONFIG_FILE": "${trigger['parameters']['KUBE_CONFIG']}",
        "NAMESPACE": "${trigger['parameters']['NAMESPACE']}",
        "SLAVE_LABEL": "evo_docker_engine_gic_IDUN"
      },
      "refId": "4",
      "requisiteStageRefIds": ["7"],
      "sendNotifications": true,
      "stageEnabled":       {
        "expression": "\"${trigger['parameters']['DEPLOYMENT_TYPE']}\" == \"install\" and ${#stage(\"Check Deployment Status\")[\"context\"][\"SKIP_DELETION\"].contains(\"false\")}",
        "type": "expression"
      },
      "type": "jenkins"
    },
        {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "OSS-Integration-Unreserve-Environment",
      "master": "maintrack-aispinn-fem12s11-eiffel004",
      "name": "UnReserve Env",
      "parameters": {"ENV_NAME": "${trigger['parameters']['RESOURCE_NAME']}"},
      "propertyFile": "",
      "refId": "6",
      "requisiteStageRefIds": ["1"],
      "type": "jenkins"
    },
        {
      "completeOtherBranchesThenFail": false,
      "continuePipeline": true,
      "failPipeline": false,
      "job": "OSS-Integration-Check-Deployment",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Check Deployment Status",
      "parameters":       {
        "INT_CHART_VERSION": "${#stage(\"Get Latest Base Chart Version\")[\"context\"][\"INT_CHART_VERSION\"]}",
        "KUBECONFIG_FILE": "${trigger['parameters']['KUBE_CONFIG']}",
        "NAMESPACE": "${trigger['parameters']['NAMESPACE']}",
        "SLAVE_LABEL": "evo_docker_engine_gic_IDUN"
      },
      "propertyFile": "artifact.properties",
      "refId": "7",
      "requisiteStageRefIds": ["8"],
      "type": "jenkins"
    },
        {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "OSS_Integration_Get_Latest_OSS_Helm_Version",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Get Latest Base Chart Version",
      "parameters":       {
        "FUNCTIONAL_USER_SECRET": "${trigger['parameters']['FUNCTIONAL_USER_SECRET']}",
        "SLAVE_LABEL": "evo_docker_engine_gic_IDUN"
      },
      "propertyFile": "artifact.properties",
      "refId": "8",
      "requisiteStageRefIds": [],
      "type": "jenkins"
    }
  ],
  "triggers": [],
  "updateTs": "1642068090133"
}